<!DOCTYPE html>
<html lang="fr">
<head>
  <link rel="icon" type="image/png" href="/favicon.png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mes Extras ¬∑ L'Officine</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://js.stripe.com/v3/"></script>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body, html { overflow-x: hidden; max-width: 100%; }

    :root {
      --bg:    #07070A;
      --bg-2:  #0D0D12;
      --panel: rgba(255,255,255,0.06);
      --stroke:  rgba(255,255,255,0.12);
      --stroke-2:rgba(255,255,255,0.18);

      /* Red palette ‚Äî no pink */
      --red:   #C8111F;
      --red-2: #A00E19;
      --red-3: #E01020;

      --text:  rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.68);
      --soft:  rgba(255,255,255,0.48);

      --shadow:    0 10px 40px rgba(0,0,0,0.55);
      --shadow-lg: 0 20px 70px rgba(0,0,0,0.72);
      --radius:    18px;
      --radius-sm: 12px;
      --radius-lg: 26px;
      --max: 1040px;
    }

    body {
      font-family: "DM Sans", system-ui, sans-serif;
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(200,17,31,0.18), transparent 60%),
        radial-gradient(900px 700px at 90% 10%,  rgba(200,17,31,0.14), transparent 55%),
        linear-gradient(180deg, var(--bg) 0%, #050507 100%);
      color: var(--text);
      min-height: 100vh;
      padding-top: 66px;
    }

    /* Ambient glow ‚Äî deep red only */
    .ambient {
      position: fixed; inset: -80px;
      pointer-events: none; z-index: 0;
      background:
        radial-gradient(800px 500px at 15% 20%, rgba(200,17,31,0.11), transparent 60%),
        radial-gradient(700px 480px at 85% 30%, rgba(160,14,25,0.10), transparent 60%),
        radial-gradient(700px 480px at 55% 90%, rgba(200,17,31,0.07), transparent 60%);
      filter: blur(18px);
      animation: drift 12s ease-in-out infinite alternate;
    }
    @keyframes drift {
      0%   { transform: translate3d(0,0,0) scale(1); }
      100% { transform: translate3d(-12px,14px,0) scale(1.03); }
    }

    /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
    header {
      position: fixed; top: 0; left: 0; width: 100%;
      z-index: 120;
      background: rgba(10,10,14,0.72);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 6px 30px rgba(0,0,0,0.35);
    }
    .header-inner {
      max-width: var(--max);
      margin: 0 auto;
      padding: 12px 18px;
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
    }
    .header-left { display: flex; align-items: center; gap: 10px; min-width: 0; }

    .brand-mark {
      height: 42px; width: 42px;
      border-radius: 999px;
      padding: 2px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25), rgba(255,255,255,0.06));
      border: 1px solid rgba(255,255,255,0.14);
      box-shadow: 0 8px 30px rgba(0,0,0,0.45);
      flex-shrink: 0;
      display: flex; align-items: center; justify-content: center;
      overflow: hidden;
    }
    .brand-mark img { height: 36px; width: 36px; object-fit: cover; border-radius: 999px; }

    .logo { font-weight: 700; letter-spacing: 0.02em; display: flex; flex-direction: column; line-height: 1.1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .logo .small { font-size: 0.72rem; color: var(--soft); font-weight: 600; letter-spacing: 0.14em; text-transform: uppercase; }
    .logo .big   { font-family: "Playfair Display", serif; font-size: 1.05rem; font-weight: 700; color: rgba(255,255,255,0.92); }

    .cart-btn {
      border: 1px solid rgba(200,17,31,0.40);
      background: linear-gradient(135deg, rgba(200,17,31,0.88), rgba(160,14,25,0.80));
      color: white;
      border-radius: 999px;
      padding: 10px 14px;
      font-size: 0.88rem; font-weight: 800;
      cursor: pointer;
      display: flex; align-items: center; gap: 10px;
      box-shadow: 0 10px 30px rgba(200,17,31,0.22);
      transition: transform .15s ease, filter .15s ease, box-shadow .15s ease;
      white-space: nowrap; flex-shrink: 0;
    }
    .cart-btn:hover { transform: translateY(-1px); filter: brightness(1.07); box-shadow: 0 14px 40px rgba(200,17,31,0.28); }

    .cart-count {
      width: 22px; height: 22px; border-radius: 999px;
      display: flex; align-items: center; justify-content: center;
      background: rgba(0,0,0,0.55);
      border: 1px solid rgba(255,255,255,0.18);
      font-size: 0.78rem; font-weight: 900;
    }
    .cart-count.bump { animation: bump .3s ease; }
    @keyframes bump { 0%,100%{transform:scale(1)} 50%{transform:scale(1.35)} }

    /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
    .hero { position: relative; z-index: 1; max-width: var(--max); margin: 18px auto 0; padding: 26px 18px 0; }
    .hero-panel {
      position: relative; overflow: hidden;
      border-radius: var(--radius-lg);
      border: 1px solid rgba(255,255,255,0.10);
      background:
        radial-gradient(900px 400px at 15% 10%, rgba(200,17,31,0.20), transparent 60%),
        radial-gradient(800px 380px at 90% 20%, rgba(200,17,31,0.22), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.03) 100%);
      box-shadow: var(--shadow-lg);
      padding: 34px 22px;
    }
    .hero-panel::before {
      content: "";
      position: absolute; inset: -2px;
      background: radial-gradient(900px 300px at 40% -10%, rgba(255,255,255,0.07), transparent 50%);
      pointer-events: none;
    }
    .hero-content { position: relative; max-width: 720px; margin: 0 auto; text-align: center; }

    .hero-badge {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid rgba(200,17,31,0.40);
      background: rgba(200,17,31,0.14);
      color: rgba(255,255,255,0.86);
      font-size: 0.78rem; font-weight: 800; letter-spacing: 0.14em; text-transform: uppercase;
      margin-bottom: 14px;
    }
    .hero h1 {
      font-family: "Playfair Display", serif;
      font-size: clamp(2.05rem, 5vw, 3.15rem);
      line-height: 1.06;
      margin-bottom: 12px;
      letter-spacing: 0.01em;
    }
    .hero h1 .accent { color: var(--red-3); }
    .hero p { color: var(--muted); font-size: 1.05rem; line-height: 1.7; max-width: 560px; margin: 0 auto; }

    .property-tag {
      display: inline-flex; align-items: center; gap: 8px;
      margin-top: 18px; padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.28);
      color: rgba(255,255,255,0.78); font-size: 0.9rem;
    }
    .property-tag strong { color: rgba(255,255,255,0.96); font-weight: 900; }

    /* ‚îÄ‚îÄ DIVIDER ‚îÄ‚îÄ */
    .divider { max-width: var(--max); margin: 18px auto 0; padding: 0 18px; z-index: 1; position: relative; }
    .divider .line {
      height: 2px; border-radius: 999px;
      background: linear-gradient(90deg, transparent, rgba(200,17,31,0.60), rgba(255,255,255,0.08), rgba(160,14,25,0.50), transparent);
      opacity: 0.9;
    }

    /* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
    main { position: relative; z-index: 1; max-width: var(--max); margin: 0 auto; padding: 22px 18px 86px; }
    .section-title { font-family: "Playfair Display", serif; font-size: 1.55rem; margin: 26px 0 8px; letter-spacing: 0.01em; }
    .section-sub   { color: var(--muted); font-size: 0.95rem; margin-bottom: 22px; }

    /* ‚îÄ‚îÄ GRID ‚îÄ‚îÄ */
    .services-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 18px; }

    /* ‚îÄ‚îÄ CARD ‚îÄ‚îÄ */
    .card {
      position: relative;
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: transform .22s ease, box-shadow .22s ease, border-color .22s ease;
      display: flex; flex-direction: column;
      min-height: 320px;
    }
    .card:hover      { transform: translateY(-4px); box-shadow: var(--shadow-lg); border-color: rgba(200,17,31,0.30); }
    .card.in-cart    { border-color: rgba(200,17,31,0.60); box-shadow: 0 20px 70px rgba(200,17,31,0.16), var(--shadow-lg); }

    .card::before {
      content: "";
      position: absolute; inset: -2px;
      background: radial-gradient(650px 220px at 20% 0%, rgba(200,17,31,0.14), transparent 55%);
      opacity: 0.9; pointer-events: none;
    }

    .card-emoji {
      position: relative; height: 120px;
      display: flex; align-items: center; justify-content: center;
      font-size: 3rem;
      background:
        radial-gradient(140px 120px at 50% 40%, rgba(200,17,31,0.22), transparent 70%),
        linear-gradient(135deg, rgba(0,0,0,0.35), rgba(255,255,255,0.04));
      border-bottom: 1px solid rgba(255,255,255,0.10);
      z-index: 1;
    }

    .in-cart-badge {
      position: absolute; top: 12px; right: 12px;
      display: none;
      padding: 6px 10px; border-radius: 999px;
      font-size: 0.74rem; font-weight: 900; letter-spacing: 0.06em; text-transform: uppercase;
      color: rgba(255,255,255,0.92);
      background: rgba(200,17,31,0.25);
      border: 1px solid rgba(200,17,31,0.50);
      backdrop-filter: blur(10px);
    }
    .card.in-cart .in-cart-badge { display: block; }

    .card-body { padding: 18px 18px 10px; display: flex; flex-direction: column; gap: 8px; flex: 1; position: relative; z-index: 1; }
    .card-name { font-family: "Playfair Display", serif; font-size: 1.12rem; letter-spacing: 0.01em; color: rgba(255,255,255,0.94); }
    .card-desc { font-size: 0.88rem; color: var(--muted); line-height: 1.6; flex: 1; }

    .card-options { margin-top: 4px; padding-top: 8px; border-top: 1px dashed rgba(255,255,255,0.10); }
    .card-options label { display: block; font-size: 0.72rem; font-weight: 900; letter-spacing: 0.14em; text-transform: uppercase; color: rgba(255,255,255,0.62); margin-top: 10px; }
    .card-options select,
    .card-options input {
      width: 100%; margin-top: 8px; padding: 10px 12px;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(0,0,0,0.35);
      color: rgba(255,255,255,0.92); outline: none; font-size: 0.92rem;
      transition: border-color .18s ease;
    }
    .card-options select:focus,
    .card-options input:focus { border-color: rgba(200,17,31,0.55); }
    .card-options input::placeholder { color: rgba(255,255,255,0.40); }

    .card-footer {
      padding: 0 18px 18px;
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
      position: relative; z-index: 1;
    }
    .card-price {
      font-size: 1.28rem; font-weight: 900; letter-spacing: 0.01em;
      background: linear-gradient(135deg, rgba(255,255,255,0.92), rgba(200,17,31,0.75));
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }
    .card-price .per { font-size: 0.75rem; font-weight: 700; color: rgba(255,255,255,0.55); margin-left: 6px; }

    .add-btn {
      border: 1px solid rgba(200,17,31,0.40);
      background: rgba(200,17,31,0.14);
      color: rgba(255,255,255,0.92);
      border-radius: 999px;
      padding: 10px 16px;
      font-size: 0.9rem; font-weight: 900;
      cursor: pointer;
      transition: transform .15s ease, filter .15s ease, background .15s ease, border-color .15s ease;
      white-space: nowrap;
    }
    .add-btn:hover { transform: translateY(-1px); filter: brightness(1.05); background: rgba(200,17,31,0.22); border-color: rgba(200,17,31,0.60); }
    .add-btn.added { background: linear-gradient(135deg, rgba(200,17,31,0.92), rgba(160,14,25,0.85)); border-color: rgba(255,255,255,0.12); box-shadow: 0 16px 40px rgba(200,17,31,0.20); }

    /* ‚îÄ‚îÄ OVERLAY / DRAWER ‚îÄ‚îÄ */
    .overlay {
      position: fixed; inset: 0;
      background: rgba(0,0,0,0.66);
      z-index: 200; opacity: 0; pointer-events: none;
      transition: opacity .28s ease;
      backdrop-filter: blur(2px);
    }
    .overlay.open { opacity: 1; pointer-events: all; }

    .drawer {
      position: fixed; top: 0; right: -460px; bottom: 0;
      width: min(460px, 100vw);
      z-index: 201; display: flex; flex-direction: column;
      background: linear-gradient(180deg, rgba(12,12,18,0.98), rgba(6,6,8,0.98));
      border-left: 1px solid rgba(255,255,255,0.10);
      box-shadow: -20px 0 70px rgba(0,0,0,0.70);
      transition: right .35s cubic-bezier(.4,0,.2,1);
    }
    .drawer.open { right: 0; }

    .drawer-header {
      padding: 22px 22px 16px;
      display: flex; align-items: center; justify-content: space-between;
      border-bottom: 1px solid rgba(255,255,255,0.10);
    }
    .drawer-title { font-family: "Playfair Display", serif; font-size: 1.35rem; color: rgba(255,255,255,0.92); letter-spacing: 0.01em; }

    .close-btn {
      width: 40px; height: 40px; border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.08);
      color: rgba(255,255,255,0.9);
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      transition: transform .15s ease, background .15s ease; font-size: 1.1rem;
    }
    .close-btn:hover { transform: rotate(2deg); background: rgba(255,255,255,0.12); }

    .drawer-items { flex: 1; overflow-y: auto; padding: 18px 22px; display: flex; flex-direction: column; gap: 14px; }

    .empty-cart { text-align: center; color: rgba(255,255,255,0.55); margin: 70px auto; font-size: 0.95rem; }
    .empty-cart .big { font-size: 3rem; display: block; margin-bottom: 10px; }

    .cart-item {
      display: flex; align-items: center; gap: 12px;
      padding: 14px; border-radius: var(--radius-sm);
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.05);
      box-shadow: 0 10px 28px rgba(0,0,0,0.35);
    }
    .cart-item-emoji  { font-size: 1.7rem; }
    .cart-item-info   { flex: 1; min-width: 0; }
    .cart-item-name   { font-weight: 900; font-size: 0.92rem; color: rgba(255,255,255,0.92); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .cart-item-detail { margin-top: 4px; font-size: 0.78rem; color: rgba(255,255,255,0.58); line-height: 1.35; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .cart-item-price  { font-weight: 900; color: rgba(255,255,255,0.92); padding-left: 6px; white-space: nowrap; }

    .remove-btn {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.12);
      color: rgba(255,255,255,0.78);
      width: 36px; height: 36px; border-radius: 10px;
      cursor: pointer;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
    }
    .remove-btn:hover { transform: translateY(-1px); border-color: rgba(200,17,31,0.50); background: rgba(200,17,31,0.15); }

    .drawer-footer {
      padding: 18px 22px 22px;
      border-top: 1px solid rgba(255,255,255,0.10);
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    }
    .total-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px; }
    .total-label  { color: rgba(255,255,255,0.62); font-size: 0.9rem; }
    .total-amount {
      font-family: "Playfair Display", serif; font-size: 1.55rem; font-weight: 900;
      background: linear-gradient(135deg, rgba(255,255,255,0.92), rgba(200,17,31,0.80));
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }

    .checkout-btn {
      width: 100%;
      border: 1px solid rgba(200,17,31,0.40);
      background: linear-gradient(135deg, rgba(200,17,31,0.94), rgba(140,10,18,0.88));
      color: white; border-radius: 999px;
      padding: 16px 18px; font-size: 1rem; font-weight: 1000;
      cursor: pointer;
      transition: transform .15s ease, filter .15s ease, box-shadow .15s ease;
      display: flex; align-items: center; justify-content: center; gap: 10px;
      box-shadow: 0 16px 55px rgba(200,17,31,0.20);
    }
    .checkout-btn:hover:not(:disabled) { transform: translateY(-1px); filter: brightness(1.06); box-shadow: 0 20px 70px rgba(200,17,31,0.25); }
    .checkout-btn:disabled { opacity: .6; cursor: not-allowed; }

    .secure-note {
      text-align: center; font-size: 0.76rem; color: rgba(255,255,255,0.55); margin-top: 10px;
      display: flex; align-items: center; justify-content: center; gap: 6px;
    }

    /* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
    .toast {
      position: fixed; bottom: 24px; left: 50%;
      transform: translateX(-50%) translateY(90px);
      z-index: 300;
      padding: 12px 18px; border-radius: 999px;
      border: 1px solid rgba(200,17,31,0.40);
      background: rgba(10,10,14,0.82);
      backdrop-filter: blur(10px);
      color: rgba(255,255,255,0.92);
      box-shadow: 0 18px 70px rgba(0,0,0,0.6);
      font-weight: 800; font-size: 0.92rem; white-space: nowrap;
      transition: transform .28s ease;
    }
    .toast.show { transform: translateX(-50%) translateY(0); }

    /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
    footer {
      position: relative; z-index: 1;
      text-align: center; padding: 26px 18px 40px;
      color: rgba(255,255,255,0.45);
      border-top: 1px solid rgba(255,255,255,0.08);
      background: rgba(0,0,0,0.18); font-size: 0.85rem;
    }

    @media (max-width: 520px) {
      body { padding-top: 70px; }
      .hero-panel { padding: 28px 16px; }
      .logo .big { font-size: 1rem; }
      .cart-btn { padding: 10px 12px; font-size: 0.86rem; }
      .services-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="ambient" aria-hidden="true"></div>

  <!-- ‚ïê‚ïê HEADER ‚ïê‚ïê -->
  <header>
    <div class="header-inner">
      <div class="header-left">
        <div class="brand-mark">
          <img src="OFFICINE1.png" alt="L'OFFICINE">
        </div>
        <div class="logo">
          <div class="small">Love Room ¬∑ Extras</div>
          <div class="big">Mes services additionnels</div>
        </div>
      </div>
      <button class="cart-btn" onclick="openCart()">
        üñ§ Mon panier
        <span class="cart-count" id="cartCount">0</span>
      </button>
    </div>
  </header>

  <!-- ‚ïê‚ïê HERO ‚ïê‚ïê -->
  <div class="hero">
    <div class="hero-panel">
      <div class="hero-content">
        <div class="hero-badge">üî• Exp√©rience Love Room</div>
        <h1>Ajoutez une touche de <span class="accent">d√©sir</span> √† votre s√©jour</h1>
        <p>Choisissez vos extras en quelques secondes. Paiement unique et s√©curis√© via Stripe ‚Äî discret, simple, imm√©diat.</p>
        <div class="property-tag">üìç Pour votre s√©jour √† <strong id="propertyName">L'Officine</strong></div>
      </div>
    </div>
  </div>

  <div class="divider" aria-hidden="true"><div class="line"></div></div>

  <!-- ‚ïê‚ïê MAIN ‚ïê‚ïê -->
  <main>
    <p class="section-title">Vos extras disponibles</p>
    <p class="section-sub">S√©lectionnez ce qui vous fait envie ¬∑ Paiement s√©curis√© ¬∑ Livraison sans tracas</p>
    <div class="services-grid" id="servicesGrid"></div>
  </main>

  <!-- ‚ïê‚ïê FOOTER ‚ïê‚ïê -->
  <footer>
    Paiement 100% s√©curis√© via Stripe ¬∑ Aucun compte requis ¬∑ ¬© 2026 L'Officine - Baln√©o &amp; pi√®ce secr√®te
  </footer>

  <!-- ‚ïê‚ïê DRAWER ‚ïê‚ïê -->
  <div class="overlay" id="overlay" onclick="closeCart()"></div>
  <div class="drawer" id="drawer">
    <div class="drawer-header">
      <div class="drawer-title">üñ§ Votre panier</div>
      <button class="close-btn" onclick="closeCart()">‚úï</button>
    </div>
    <div class="drawer-items" id="drawerItems">
      <div class="empty-cart"><span class="big">üõí</span>Votre panier est vide</div>
    </div>
    <div class="drawer-footer">
      <div class="total-row">
        <div class="total-label">Total √† r√©gler</div>
        <div class="total-amount" id="totalAmount">0,00 ‚Ç¨</div>
      </div>
      <button class="checkout-btn" id="checkoutBtn" onclick="checkout()">üí≥ Payer maintenant</button>
      <div class="secure-note">üîí Paiement chiffr√© ¬∑ Powered by Stripe</div>
    </div>
  </div>

  <!-- ‚ïê‚ïê TOAST ‚ïê‚ïê -->
  <div class="toast" id="toast"></div>

  <script>
    const CONFIG = {
      stripePublicKey: 'pk_live_51T2sCWEQXQOSFAvYReJfFZ9wGgP1YHoq43wY3jCoS0gr6wxVqx9gmQiyPPm8ZnJK60V8F7b1aQ1TGD4ikHomJQT000UpCnCgyB',
      checkoutEndpoint: '/.netlify/functions/create-checkout-session',
      propertyName: "L'Officine",
    };

    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('property')) CONFIG.propertyName = decodeURIComponent(urlParams.get('property'));
    document.getElementById('propertyName').textContent = CONFIG.propertyName;

    const SERVICES = [
      {
        id: 'late_checkout', emoji: 'üïõ',
        name: 'D√©part tardif',
        desc: 'Quittez le logement jusqu\'√† 12h00 sans stress. Profitez d\'une derni√®re grasse mat\'.',
        price: 20, per: '/ s√©jour', stripePriceId: 'price_1T3YgpEQXQOSFAvYcTkdgweM',
        options: [{ label: 'Heure de d√©part', type: 'select', name: 'heure', choices: ['12h00'] }]
      },
      {
        id: 'early_checkin', emoji: 'üîë',
        name: 'Arriv√©e anticip√©e',
        desc: 'Acc√©dez au logement d√®s 10h pour commencer votre s√©jour sur les chapeaux de roue.',
        price: 20, per: '/ s√©jour', stripePriceId: 'price_1T3YemEQXQOSFAvYxSxYutZE',
        options: [{ label: 'Heure d\'arriv√©e', type: 'select', name: 'heure', choices: ['15h00'] }]
      },
      {
        id: 'menage', emoji: '‚ú®',
        name: 'M√©nage interm√©diaire',
        desc: 'Un coup de propre au milieu du s√©jour : linge de maison frais et appartement nickel.',
        price: 1, per: '/ passage', stripePriceId: 'price_1T3fStEQXQOSFAvYeWHDGcAb',
        options: []
      },
      {
        id: 'prosecco', emoji: 'ü•Ç',
        name: 'Prosecco',
        desc: 'Une bouteille de prosecco vous attend √† votre arriv√©e, au frais.',
        price: 25, per: '/ bouteille', stripePriceId: 'price_1T3fUZEQXQOSFAvYikUy5aJg',
        options: []
      },
      {
        id: 'champagne', emoji: 'üçæ',
        name: 'Bouteille de champagne',
        desc: 'Une bouteille de champagne mill√©sim√© vous attend √† votre arriv√©e, au frais.',
        price: 50, per: '/ bouteille', stripePriceId: 'price_1T2sIbEQXQOSFAvYQOq3vbmQ',
        options: []
      },
      {
        id: 'vin_blanc', emoji: 'üç∑',
        name: 'Bouteille de vin blanc',
        desc: 'Une bouteille de vin blanc vous attend √† votre arriv√©e, au frais.',
        price: 25, per: '/ bouteille', stripePriceId: 'price_1T3fYGEQXQOSFAvYeL53Lo1X',
        options: []
      },
      {
        id: 'breakfast', emoji: 'ü•ê',
        name: 'Panier petit-d√©jeuner',
        desc: 'Croissants, jus de fruits, caf√©, confiture artisanale et viennoiseries locales.',
        price: 35, per: '/ pour deux pers.', stripePriceId: 'price_1T3fVFEQXQOSFAvYLxxXjVUX',
        options: []
      },
      {
        id: 'panier_local', emoji: 'üß∫',
        name: 'Panier de produits locaux',
        desc: 'S√©lection de sp√©cialit√©s r√©gionales : fromages, charcuterie, vins et douceurs.',
        price: 40, per: '/ panier', stripePriceId: 'price_1T3fvmEQXQOSFAvYRPVsrrQ7',
        options: []
      },
      {
        id: 'pack_arrivee_depart', emoji: 'üïù',
        name: 'Pack : arriv√©e tardive & d√©part tardif',
        desc: 'Arriv√©e anticip√©e et d√©part tardif r√©unis en un seul avantage.',
        price: 35, per: '/ s√©jour', stripePriceId: 'price_1T3fwiEQXQOSFAvYVAKQ3ybw',
        options: []
      },
    ];

    let cart = [];

    function renderServices() {
      document.getElementById('servicesGrid').innerHTML = SERVICES.map(s => `
        <div class="card" id="card-${s.id}">
          <div class="card-emoji">
            ${s.emoji}
            <div class="in-cart-badge">‚úì Ajout√©</div>
          </div>
          <div class="card-body">
            <div class="card-name">${s.name}</div>
            <div class="card-desc">${s.desc}</div>
            ${s.options.length ? `<div class="card-options">${s.options.map(o => renderOpt(s.id, o)).join('')}</div>` : ''}
          </div>
          <div class="card-footer">
            <div class="card-price">${s.price}‚Ç¨ <span class="per">${s.per}</span></div>
            <button class="add-btn" id="btn-${s.id}" onclick="addToCart('${s.id}')">Ajouter</button>
          </div>
        </div>`).join('');
    }

    function renderOpt(sid, opt) {
      if (opt.type === 'select') return `<label>${opt.label}</label><select id="opt-${sid}-${opt.name}">${opt.choices.map(c=>`<option>${c}</option>`).join('')}</select>`;
      return `<label>${opt.label}</label><input type="text" id="opt-${sid}-${opt.name}" placeholder="${opt.placeholder||''}">`;
    }

    function addToCart(id) {
      const s = SERVICES.find(s => s.id === id);
      const opts = {};
      s.options.forEach(o => { const el = document.getElementById(`opt-${id}-${o.name}`); if(el) opts[o.name] = el.value; });
      cart.push({ service: s, options: opts, unitPrice: s.price });
      updateCartUI();
      showToast(`${s.emoji} ${s.name} ajout√© !`);
      document.getElementById(`card-${id}`).classList.add('in-cart');
      const btn = document.getElementById(`btn-${id}`);
      btn.textContent = 'Ajout√© ‚úì'; btn.classList.add('added');
    }

    function removeFromCart(i) {
      const item = cart[i];
      cart.splice(i, 1);
      if (!cart.some(c => c.service.id === item.service.id)) {
        document.getElementById(`card-${item.service.id}`)?.classList.remove('in-cart');
        const btn = document.getElementById(`btn-${item.service.id}`);
        if (btn) { btn.textContent = 'Ajouter'; btn.classList.remove('added'); }
      }
      updateCartUI();
    }

    function updateCartUI() {
      const el = document.getElementById('cartCount');
      el.textContent = cart.length; el.classList.add('bump');
      setTimeout(() => el.classList.remove('bump'), 350);
      document.getElementById('totalAmount').textContent =
        cart.reduce((s,i)=>s+i.unitPrice,0).toLocaleString('fr-FR',{style:'currency',currency:'EUR'});
      renderCartItems();
    }

    function renderCartItems() {
      const el = document.getElementById('drawerItems');
      if (!cart.length) { el.innerHTML = '<div class="empty-cart"><span class="big">üõí</span>Votre panier est vide</div>'; return; }
      el.innerHTML = cart.map((item,i) => `
        <div class="cart-item">
          <div class="cart-item-emoji">${item.service.emoji}</div>
          <div class="cart-item-info">
            <div class="cart-item-name">${item.service.name}</div>
            <div class="cart-item-detail">${Object.values(item.options).join(' ¬∑ ')||''}</div>
          </div>
          <div class="cart-item-price">${item.unitPrice}‚Ç¨</div>
          <button class="remove-btn" onclick="removeFromCart(${i})">üóë</button>
        </div>`).join('');
    }

    function openCart() {
      document.getElementById('overlay').classList.add('open');
      document.getElementById('drawer').classList.add('open');
      document.body.style.overflow = 'hidden';
    }
    function closeCart() {
      document.getElementById('overlay').classList.remove('open');
      document.getElementById('drawer').classList.remove('open');
      document.body.style.overflow = '';
    }

    let toastTimer;
    function showToast(msg) {
      const el = document.getElementById('toast');
      el.textContent = msg; el.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => el.classList.remove('show'), 2800);
    }

    async function checkout() {
      if (!cart.length) { showToast('Ajoutez au moins un service üòä'); return; }
      const btn = document.getElementById('checkoutBtn');
      btn.disabled = true; btn.textContent = 'Chargement‚Ä¶';
      try {
        const res = await fetch(CONFIG.checkoutEndpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            line_items: cart.map(i => ({ price: i.service.stripePriceId, quantity: 1 })),
            metadata: { property: CONFIG.propertyName, items: JSON.stringify(cart.map(i=>({name:i.service.name,options:i.options}))) },
            success_url: window.location.href + '?success=1',
            cancel_url: window.location.href,
          })
        });
        const { url, error } = await res.json();
        if (error) throw new Error(error);
        if (url) window.location.href = url;
      } catch(e) {
        showToast('Erreur de paiement ‚Äî r√©essayez üôè');
        btn.disabled = false; btn.innerHTML = 'üí≥ Payer maintenant';
      }
    }

    if (urlParams.get('success') === '1')
      setTimeout(() => showToast('üéâ Merci ! Votre commande a bien √©t√© re√ßue.'), 500);

    renderServices();
  </script>
</body>
</html>












